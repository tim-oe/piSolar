# Renogy Rover RS485 Connection Guide

> **WARNING: NOT YET VERIFIED**
> 
> This pinout is based on community sources and has NOT been tested.
> Verify with a multimeter before connecting. If you verify this works,
> please update the status.

This guide covers wiring a USB-to-RS485 adapter to the Renogy Rover charge controller.

---

## Equipment Needed

- USB to RS485 adapter (e.g., Waveshare USB to RS485 converter)
- Raspberry Pi (or any computer with USB)
- RJ45 cable or RJ45 to screw terminal adapter
- Multimeter (for verification)

---

## Hardware Configuration

**Waveshare Converter Settings:**
- Set jumpers/switch to **RS485 mode**
- Use RS485 screw terminals (3-wire connection)

---

## RJ45 Connector Pinout

The Renogy Rover uses an **RJ45 (8P8C)** connector (looks like Ethernet).

**Pin Identification:**
- Hold RJ45 plug with tab/clip facing DOWN
- Cable entry facing AWAY from you
- Pins numbered LEFT to RIGHT: 1, 2, 3, 4, 5, 6, 7, 8

**RJ45 Pinout (NOT VERIFIED - from community sources):**
```
Pin 1: Not used
Pin 2: A+ / Data+ (TX/RX +)
Pin 3: B- / Data- (TX/RX -)
Pin 4: GND (Ground)
Pin 5: GND (Ground)
Pin 6: Not used
Pin 7: Not used
Pin 8: Not used
```

**Sources:**
- [DIYSolarForum RS-485 thread](https://diysolarforum.com/threads/renogy-rs-485-communications-interface-in-detail.12495/)
- [Renogy Modbus Research (GitHub)](https://github.com/sdellysse/renogy-modbus-research)

---

## Wiring Diagram

**RJ45 → RS485 Adapter:**
```
RJ45 Pin 2 (A / Data+) ──→ Adapter A+ / D+
RJ45 Pin 3 (B / Data-) ──→ Adapter B- / D-
RJ45 Pin 4 (GND)       ──→ Adapter GND
```

**If using Waveshare USB to RS232/485 screw terminals:**
```
RJ45 Pin 2 (A+) ──→ TX_A (in RS485 mode = A+)
RJ45 Pin 3 (B-) ──→ RX_B (in RS485 mode = B-)
RJ45 Pin 4 (GND) ─── GND
```

---

## Connection Notes

- RS485 uses differential signaling (A+ and B-)
- Ground connection is required for proper operation
- Either Pin 4 or Pin 5 can be used for ground (tied together)
- **Polarity matters**: A must go to A+, B must go to B-
- If communication fails, try swapping A and B wires
- For long cable runs (>10m), enable 120Ω termination resistor
- **Verify pinout with multimeter before connecting** - measure for signal activity

---

## Communication Parameters

```
Baud Rate:    9600
Data Bits:    8
Stop Bits:    1
Parity:       None
Protocol:     Modbus RTU
Slave Addr:   1
```

---

## Raspberry Pi Setup

1. **Connect adapter to Raspberry Pi:**
   - Plug USB converter into any USB port
   - No drivers needed (automatic recognition)

2. **Verify connection:**
```bash
# List USB devices
lsusb

# Check for serial device
ls /dev/ttyUSB*

# Should show: /dev/ttyUSB0 (or ttyUSB1, ttyUSB2, etc.)
```

3. **Set permissions:**
```bash
# Add user to dialout group
sudo usermod -a -G dialout $USER

# Log out and back in for changes to take effect
```

---

## Testing Connection

### Test with PyModbus

```bash
# Install dependencies
pip3 install pymodbus pyserial
```

**Test Script (pymodbus 3.10+):**
```python
#!/usr/bin/env python3
from pymodbus.client import ModbusSerialClient

# Create connection
client = ModbusSerialClient(
    port='/dev/ttyUSB0',
    baudrate=9600,
    bytesize=8,
    parity='N',
    stopbits=1,
    timeout=3
)

# Connect and read data
# Note: pymodbus 3.10+ uses device_id= instead of slave=
if client.connect():
    # Read battery SOC (register 0x0100)
    result = client.read_holding_registers(address=0x0100, count=1, device_id=1)
    if not result.isError():
        print(f"Battery SOC: {result.registers[0]}%")
    
    # Read battery voltage (register 0x0101)
    result = client.read_holding_registers(address=0x0101, count=1, device_id=1)
    if not result.isError():
        print(f"Battery Voltage: {result.registers[0] * 0.1}V")
    
    # Read solar voltage (register 0x0107)
    result = client.read_holding_registers(address=0x0107, count=1, device_id=1)
    if not result.isError():
        print(f"Solar Voltage: {result.registers[0] * 0.1}V")
    
    client.close()
else:
    print("Connection failed")
```

**For pymodbus < 3.10, use `slave=` instead of `device_id=`:**
```python
result = client.read_holding_registers(0x0100, 1, slave=1)
```

---

## Common Modbus Registers

| Register | Description | Unit | Scale Factor |
|----------|-------------|------|--------------|
| 0x0100 | Battery SOC | % | 1 |
| 0x0101 | Battery Voltage | V | 0.1 |
| 0x0102 | Charging Current | A | 0.01 |
| 0x0103 | Controller Temperature | °C | 1 (signed) |
| 0x0107 | Solar Panel Voltage | V | 0.1 |
| 0x0108 | Solar Panel Current | A | 0.01 |
| 0x0109 | Solar Panel Power | W | 1 |
| 0x010B | Load Voltage | V | 0.1 |
| 0x010C | Load Current | A | 0.01 |
| 0x010D | Load Power | W | 1 |

---

## Troubleshooting

### No Communication

**Check the following:**
1. Verify RS485 mode is set on adapter
2. Confirm A+ to A+ and B- to B- connections
3. If no response, try swapping A and B wires
4. Ensure ground is connected
5. Verify controller is powered on
6. Check `/dev/ttyUSB*` device exists
7. Confirm user is in `dialout` group

### Long Cable Runs

- Check termination resistors if using long cables (>10m)
- RS485 supports up to ~1200 meters with proper termination

### Still Not Working?

```python
# Enable detailed Modbus debugging
import logging
logging.basicConfig()
log = logging.getLogger()
log.setLevel(logging.DEBUG)
```

---

## RS485 vs RS232 Comparison

| Feature | RS232 (Wanderer) | RS485 (Rover) |
|---------|------------------|---------------|
| Connector | RJ12 (6-pin) | RJ45 (8-pin) |
| Max Distance | ~15 meters | ~1200 meters |
| Wiring | 3-wire (TX, RX, GND) | 3-wire (A+, B-, GND) |
| Multi-drop | No | Yes (up to 32 devices) |
| Noise Immunity | Low | High |
| Signal Type | Single-ended | Differential |
| Best Use | Short distances | Long distances, industrial |

---

## Safety Notes

- Always power off controllers before connecting/disconnecting
- Double-check polarity on RS485 connections
- Ensure all connections are secure before powering on

---

## Additional Resources

- **Renogy RS485 Cable:** https://renogy.com/rs485-to-usb-serial-cable/
- **PyModbus Documentation:** https://pymodbus.readthedocs.io/
- **renogymodbus Python Library:** https://github.com/rosswarren/renogymodbus
- **Renogy Modbus Research (protocol docs):** https://github.com/sdellysse/renogy-modbus-research
- **DIYSolarForum RS485 Thread:** https://diysolarforum.com/threads/renogy-rs-485-communications-interface-in-detail.12495/
- **Elecrow RS485Bridge for Renogy:** https://www.elecrow.com/rs485bridge-with-rj45-for-renogy.html
- **Waveshare USB to RS232/485:** https://www.waveshare.com/usb-to-rs232-485.htm

---

## Revision History

- **v1.1** - Updated pinout based on community sources (pins 2,3,4 not 3,6,4), added warning
- **v1.0** - Initial guide (split from SERIAL.md, not yet verified)
